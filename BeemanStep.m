function [F] = BeemanStep(S, A, H, I)
    T0 = S(1, I - 1);
    X0 = S(2 : 5, I - 1);
    V0 = S(6 : 9, I - 1);
    T1 = S(1, I);
    X1 = S(2 : 5, I);
    V1 = S(6 : 9, I);
    
    A0 = A(X0(1), X0(2), X0(3), X0(4), V0(1), V0(2), V0(3), V0(4));
    A1 = A(X1(1), X1(2), X1(3), X1(4), V1(1), V1(2), V1(3), V1(4));
    
    T = T1 + H;    
    X = X1 + H * (V1 + H * (4 * A1 - A0) / 6);
    V = V1 + H * (3 * A1 - A0) / 2;
    
    A2 = A(X(1), X(2), X(3), X(4), V(1), V(2), V(3), V(4));
    
    V = V1 + H * (5 * A2 + 8 * A1 - A0) / 12;

    F = [T; X(1); X(2); X(3); X(4); V(1); V(2); V(3); V(4)];
end